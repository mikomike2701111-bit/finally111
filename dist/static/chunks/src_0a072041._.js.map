{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/product/product-purchase-form.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport type { Product } from '@/lib/types';\nimport { Button } from '@/components/ui/button';\nimport { Minus, Plus } from 'lucide-react';\nimport { useAppContext } from '@/context/AppContext';\nimport { cn } from '@/lib/utils';\nimport { usePaystackPayment } from 'react-paystack';\nimport { useToast } from '@/hooks/use-toast';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from '@/components/ui/dialog';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport { z } from 'zod';\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { kenyanCounties } from '@/lib/kenyan-counties';\nimport { useFirestore, useUser, addDocumentNonBlocking } from '@/firebase';\nimport { collection, serverTimestamp } from 'firebase/firestore';\n\n\ninterface ProductPurchaseFormProps {\n  product: Product;\n  selectedColor: string | undefined;\n  setSelectedColor: (color: string) => void;\n}\n\nconst WhatsAppIcon = () => (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 448 512\"\n      className=\"h-5 w-5\"\n    >\n      <path fill=\"black\" d=\"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 .2c54.9 0 105.8 21.2 144.2 59.5 38.2 38.3 59.5 89.4 59.5 144.2 0 112.2-91.5 203.7-203.7 203.7-35.1 0-69.2-9-98.7-25.9l-7.1-4.2-73.3 19.3 19.7-71.5-4.5-7.4c-18.4-30.6-28.2-66.2-28.2-103.5 0-112.2 91.5-203.7 203.7-203.7zM223.9 150.1c-12.2 0-22.1 9.9-22.1 22.1v.1c0 12.2 9.9 22.1 22.1 22.1 6.1 0 11.6-2.5 15.6-6.5 3.9-3.9 6.5-9.4 6.5-15.6-.1-12.2-10-22.1-22.1-22.1zm53.8 141.2c-4.4-2.2-26.2-12.9-30.3-14.4-4.1-1.5-7.1-2.2-10.1 2.2s-11.4 14.4-14 17.3c-2.6 3-5.2 3.3-9.6 1.1-4.4-2.2-18.6-6.9-35.4-21.8-13-11.7-21.8-26.2-24.4-30.6-2.6-4.4-.3-6.9 1.9-9.1 2-2 4.4-5.2 6.6-7.8 2.2-2.6 3-4.4 1.5-7.4-1.5-3-10.1-24.3-13.8-33.3-3.7-8.9-7.5-7.7-10.1-7.8h-9.1c-2.6 0-7.1.3-10.9 4.4-3.8 4.1-14.6 14.3-14.6 34.9 0 20.6 15 40.5 17.1 43.5 2.1 3 29.5 44.9 71.9 62.8 10.4 4.4 18.5 7.1 24.8 9.1 6.3 2 12.1 1.7 16.7.7 5.2-.9 26.2-10.7 29.9-21.1 3.7-10.4 3.7-19.3 2.6-21.1-1.1-1.9-4.1-3-8.5-5.2z\" />\n    </svg>\n  );\n\nconst addressSchema = z.object({\n  county: z.string().min(1, 'County is required'),\n  region: z.string().min(1, 'Region/Town is required'),\n  description: z.string().min(1, 'Address description is required'),\n});\ntype AddressFormData = z.infer<typeof addressSchema>;\n\nconst fallbackColors = ['#111827', '#f9fafb', '#4b5563', '#9ca3af'];\nconst sizes = ['S', 'M', 'L', 'XL'];\n\nexport default function ProductPurchaseForm({ product, selectedColor, setSelectedColor }: ProductPurchaseFormProps) {\n  const { addToCart, toggleWishlist, isProductInWishlist } = useAppContext();\n  const [selectedSize, setSelectedSize] = useState('M');\n  const [quantity, setQuantity] = useState(1);\n  const [isAddressDialogOpen, setIsAddressDialogOpen] = useState(false);\n  const [addressData, setAddressData] = useState<AddressFormData | null>(null);\n\n  const isInWishlist = isProductInWishlist(product.id);\n  const { toast } = useToast();\n  const firestore = useFirestore();\n  const { user } = useUser();\n  \n  const addressForm = useForm<AddressFormData>({\n    resolver: zodResolver(addressSchema),\n    defaultValues: { county: '', region: '', description: '' },\n  });\n\n  const availableSizes = product.sizes || ['S', 'M', 'L'];\n\n\n  const handleAddToCart = () => {\n    addToCart(product, quantity);\n  };\n\n  const handleToggleWishlist = () => {\n    toggleWishlist(product.id);\n  };\n  \n  const handleBuyViaWhatsApp = () => {\n    const selectedColorName = product.availableColors?.find(c => c.hex === selectedColor)?.name;\n    const colorText = selectedColorName ? ` in color ${selectedColorName}` : '';\n    const message = `Hi Eddjos, I would like to order ${quantity} of the ${product.name}${colorText} in Size ${selectedSize}. Price: Ksh ${(product.price * quantity).toFixed(2)}.`;\n    const encodedMessage = encodeURIComponent(message);\n    const whatsappUrl = `https://wa.me/254740685488?text=${encodedMessage}`;\n    window.open(whatsappUrl, '_blank');\n  };\n  \n  const paystackConfig = {\n    reference: (new Date()).getTime().toString(),\n    email: \"customer@example.com\", // Using a placeholder email\n    amount: product.price * quantity * 100, // Amount in cents\n    publicKey: process.env.NEXT_PUBLIC_PAYSTACK_PUBLIC_KEY || '',\n    currency: 'KES',\n    metadata: {\n      productName: product.name,\n      quantity,\n      size: selectedSize,\n      custom_fields: [\n        { display_name: \"Product Name\", variable_name: \"product_name\", value: product.name },\n        { display_name: \"Quantity\", variable_name: \"quantity\", value: quantity },\n        { display_name: \"Size\", variable_name: \"size\", value: selectedSize },\n        { display_name: \"County\", variable_name: \"shipping_county\", value: addressData?.county || \"\" },\n        { display_name: \"Region\", variable_name: \"shipping_region\", value: addressData?.region || \"\" },\n        { display_name: \"Address Description\", variable_name: \"shipping_description\", value: addressData?.description || \"\" }\n      ]\n    }\n  };\n\n  const initializePayment = usePaystackPayment(paystackConfig);\n\n  const onPaystackSuccess = (reference: any) => {\n    if (!firestore || !user || !addressData) {\n        toast({ variant: \"destructive\", title: \"Error\", description: \"Could not save order. User or address missing.\"});\n        return;\n    }\n    \n    const orderData = {\n        userId: user.uid,\n        products: [{ id: product.id, name: product.name, quantity, price: product.price }],\n        totalAmount: product.price * quantity,\n        shippingAddress: addressData,\n        status: 'pending' as const,\n        createdAt: serverTimestamp(),\n    };\n    \n    addDocumentNonBlocking(collection(firestore, 'orders'), orderData);\n    \n    toast({\n        title: \"Payment Successful!\",\n        description: `Thank you for your purchase. Reference: ${reference.reference}`,\n    });\n  };\n\n  const onPaystackClose = () => {\n      // Silent on close as it's triggered on success as well.\n  };\n\n  const handleAddressSubmit = (data: AddressFormData) => {\n    setAddressData(data);\n    setIsAddressDialogOpen(false);\n    initializePayment({ onSuccess: onPaystackSuccess, onClose: onPaystackClose });\n  };\n\n  const handlePayNowClick = () => {\n      if (!process.env.NEXT_PUBLIC_PAYSTACK_PUBLIC_KEY) {\n          toast({\n              variant: \"destructive\",\n              title: \"Configuration Error\",\n              description: \"Paystack payment is not configured correctly.\"\n          });\n          return;\n      }\n      setIsAddressDialogOpen(true);\n  };\n\n  const colorOptions = product.availableColors || fallbackColors.map(hex => ({ name: hex, hex }));\n\n\n  return (\n    <>\n    <div className=\"bg-white p-4 sm:p-8 rounded-2xl shadow-sm space-y-6\">\n      <div>\n        <div className=\"flex justify-between items-start gap-4\">\n          <h1 className=\"text-3xl font-bold\">{product.name}</h1>\n          <button\n            onClick={handleToggleWishlist}\n            className={cn(\n                \"wishlist-btn\",\n                isInWishlist && \"active\"\n            )}\n            aria-label=\"Add to wishlist\"\n            >\n            <div className=\"particles\">\n                <span style={{'--i': 1} as React.CSSProperties}></span>\n                <span style={{'--i': 2} as React.CSSProperties}></span>\n                <span style={{'--i': 3} as React.CSSProperties}></span>\n                <span style={{'--i': 4} as React.CSSProperties}></span>\n                <span style={{'--i': 5} as React.CSSProperties}></span>\n                <span style={{'--i': 6} as React.CSSProperties}></span>\n            </div>\n            <svg viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"\n                stroke=\"black\" strokeWidth=\"1.5\"/>\n            </svg>\n        </button>\n        </div>\n      </div>\n\n      {colorOptions.length > 0 && (\n        <div>\n          <h3 className=\"text-sm font-medium text-gray-900\">Color</h3>\n          <div className=\"flex items-center gap-3 mt-2\">\n            {colorOptions.map((color) => (\n              <button\n                key={color.name}\n                onClick={() => setSelectedColor(color.hex)}\n                className={`w-8 h-8 rounded-full border-2 transition-all ${selectedColor === color.hex ? 'border-primary ring-2 ring-primary ring-offset-2' : 'border-gray-200'}`}\n                style={{ backgroundColor: color.hex }}\n              >\n                <span className=\"sr-only\">{color.name}</span>\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n      \n      <div className=\"flex justify-between items-end\">\n        <div>\n          <h3 className=\"text-sm font-medium text-gray-900\">Size</h3>\n          <div className=\"flex flex-wrap items-center gap-2 mt-2\">\n            {sizes.map((size) => {\n              const isAvailable = availableSizes.includes(size);\n              return (\n                <Button\n                  key={size}\n                  variant={selectedSize === size ? 'default' : 'outline'}\n                  disabled={!isAvailable}\n                  onClick={() => setSelectedSize(size)}\n                  className={`rounded-full px-4 py-2 ${!isAvailable ? 'text-gray-400 line-through' : ''}`}\n                >\n                  {size}\n                </Button>\n              );\n            })}\n          </div>\n        </div>\n        <a href=\"#\" className=\"text-sm text-primary hover:underline\">Size Guide</a>\n      </div>\n\n      <div>\n        <h3 className=\"text-sm font-medium text-gray-900\">Quantity</h3>\n        <div className=\"flex items-center gap-4 mt-2\">\n          <div className=\"flex items-center border rounded-full\">\n            <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full\" onClick={() => setQuantity(q => Math.max(1, q - 1))}>\n              <Minus className=\"w-4 h-4\" />\n            </Button>\n            <span className=\"w-10 text-center font-semibold\">{quantity}</span>\n            <Button variant=\"ghost\" size=\"icon\" className=\"rounded-full\" onClick={() => setQuantity(q => q + 1)}>\n              <Plus className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n      \n      <div className=\"border-t pt-6 space-y-4\">\n        <div className=\"flex justify-between items-center\">\n            <span className=\"text-lg text-gray-500\">Total Price</span>\n            <p className=\"text-3xl font-bold\">Ksh {(product.price * quantity).toFixed(2)}</p>\n        </div>\n        <div className=\"grid grid-cols-1 gap-2\">\n            <Button size=\"lg\" className=\"w-full rounded-full h-12 text-base font-bold\" onClick={handleAddToCart}>Add to Cart</Button>\n            <Button size=\"lg\" variant=\"default\" className=\"w-full rounded-full h-12 text-base font-bold\" onClick={handlePayNowClick}>Pay Now</Button>\n            <Button size=\"lg\" variant=\"tactile-green\" className=\"w-full rounded-full h-12 text-base font-bold\" onClick={handleBuyViaWhatsApp}>\n                <WhatsAppIcon />\n                Buy via WhatsApp\n            </Button>\n        </div>\n      </div>\n\n      <div>\n        <h3 className=\"text-base font-semibold text-gray-900\">Description</h3>\n        <p className=\"mt-2 text-gray-600 text-sm leading-relaxed\">\n          {product.description}\n        </p>\n      </div>\n    </div>\n    <Dialog open={isAddressDialogOpen} onOpenChange={setIsAddressDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Shipping Address</DialogTitle>\n          </DialogHeader>\n          <Form {...addressForm}>\n            <form onSubmit={addressForm.handleSubmit(handleAddressSubmit)} className=\"space-y-4 py-4\">\n              <FormField control={addressForm.control} name=\"county\" render={({ field }) => (\n                <FormItem>\n                  <FormLabel>County</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl><SelectTrigger><SelectValue placeholder=\"Select a county\" /></SelectTrigger></FormControl>\n                    <SelectContent>\n                      {kenyanCounties.map(county => <SelectItem key={county} value={county}>{county}</SelectItem>)}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}/>\n              <FormField control={addressForm.control} name=\"region\" render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Region / Town</FormLabel>\n                  <FormControl><Input placeholder=\"e.g., Westlands\" {...field} /></FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}/>\n              <FormField control={addressForm.control} name=\"description\" render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Address Description</FormLabel>\n                  <FormControl><Textarea placeholder=\"e.g., Building name, street, house number\" {...field} /></FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}/>\n              <DialogFooter>\n                <Button type=\"submit\">Proceed to Payment</Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 877, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n"],"names":[],"mappings":";;;;;AAAA;;;AAEA,SAAS,SAAS,KAGqB;QAHrB,EAChB,SAAS,EACT,GAAG,OACkC,GAHrB;IAIhB,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EAAC,qCAAqC;QAClD,GAAG,KAAK;;;;;;AAGf;KAVS","debugId":null}},
    {"offset": {"line": 907, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/carousel.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1226, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/product/ProductReviews.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Star, Send } from 'lucide-react';\nimport { useCollection, useFirestore, useUser, useMemoFirebase, addDocumentNonBlocking } from '@/firebase';\nimport { collection, query, orderBy, serverTimestamp, Timestamp } from 'firebase/firestore';\nimport type { Review as ReviewType, WithId } from '@/lib/types';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\nimport { Carousel, CarouselContent, CarouselItem } from '@/components/ui/carousel';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { cn } from '@/lib/utils';\nimport { formatDistanceToNow } from 'date-fns';\nimport { useToast } from '@/hooks/use-toast';\n\n\nconst reviewSchema = z.object({\n  userName: z.string().min(2, { message: \"Name must be at least 2 characters.\" }).max(50, { message: \"Name cannot be longer than 50 characters.\" }),\n  rating: z.number().min(1, { message: \"Please select a rating.\" }),\n  comment: z.string().min(10, { message: \"Review must be at least 10 characters.\" }).max(500, { message: \"Review cannot be longer than 500 characters.\" }),\n});\n\nfunction ReviewCard({ review }: { review: WithId<ReviewType> }) {\n  const date = review.createdAt ? (review.createdAt as Timestamp).toDate() : new Date();\n\n  return (\n    <div className=\"p-1 h-full\">\n      <div className=\"w-full h-full bg-gray-50 rounded-2xl p-6 border border-gray-200 shadow-sm flex flex-col justify-between transition-transform duration-300 hover:-translate-y-1\">\n        <div>\n          <div className=\"flex items-center gap-1 mb-4\">\n            {[...Array(5)].map((_, i) => (\n              <Star\n                key={i}\n                className={cn(\n                  \"w-5 h-5\",\n                  i < review.rating ? \"text-yellow-400 fill-yellow-400\" : \"text-gray-300\"\n                )}\n              />\n            ))}\n          </div>\n          <p className=\"text-gray-600 text-sm italic line-clamp-5\">\"{review.comment}\"</p>\n        </div>\n        <div className=\"mt-4 text-right\">\n          <p className=\"font-semibold text-gray-900\">{review.userName}</p>\n          <p className=\"text-xs text-gray-500\">{formatDistanceToNow(date, { addSuffix: true })}</p>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst StarRatingInput = ({ value, onChange }: { value: number, onChange: (value: number) => void }) => {\n    const [hover, setHover] = useState(0);\n    return (\n        <div className=\"flex items-center space-x-1\">\n            {[...Array(5)].map((_, index) => {\n                const ratingValue = index + 1;\n                return (\n                    <button\n                        type=\"button\"\n                        key={ratingValue}\n                        onClick={() => onChange(ratingValue)}\n                        onMouseEnter={() => setHover(ratingValue)}\n                        onMouseLeave={() => setHover(0)}\n                        aria-label={`Rate ${ratingValue} stars`}\n                    >\n                        <Star\n                            className={cn(\n                                \"w-7 h-7 cursor-pointer transition-colors\",\n                                ratingValue <= (hover || value) ? \"text-yellow-400 fill-yellow-400\" : \"text-gray-300\"\n                            )}\n                        />\n                    </button>\n                );\n            })}\n        </div>\n    );\n};\n\nexport default function ProductReviews({ productId }: { productId: string }) {\n  const { toast } = useToast();\n  const firestore = useFirestore();\n  const { user, isUserLoading } = useUser();\n\n  const reviewsQuery = useMemoFirebase(\n    () => firestore ? query(collection(firestore, 'products', productId, 'reviews'), orderBy('createdAt', 'desc')) : null,\n    [firestore, productId]\n  );\n  const { data: reviews, isLoading: isLoadingReviews } = useCollection<ReviewType>(reviewsQuery);\n\n  const form = useForm<z.infer<typeof reviewSchema>>({\n    resolver: zodResolver(reviewSchema),\n    defaultValues: {\n      userName: \"\",\n      rating: 0,\n      comment: \"\",\n    },\n  });\n  \n  const { formState: { isSubmitting } } = form;\n  \n  useEffect(() => {\n    if (user && !form.getValues('userName')) {\n        form.setValue('userName', user.isAnonymous ? 'Anonymous' : user.displayName || 'Guest');\n    }\n  }, [user, form]);\n\n  async function onSubmit(values: z.infer<typeof reviewSchema>) {\n    if (!firestore || !user) {\n        toast({\n            variant: \"destructive\",\n            title: \"Authentication Error\",\n            description: \"You must be signed in to leave a review.\",\n        });\n        return;\n    }\n    \n    const reviewData = {\n        ...values,\n        userId: user.uid,\n        createdAt: serverTimestamp(),\n    };\n\n    addDocumentNonBlocking(collection(firestore, 'products', productId, 'reviews'), reviewData)\n        .then(() => {\n            toast({\n                title: \"Review Submitted!\",\n                description: \"Thank you for your feedback.\",\n            });\n            form.reset({\n                userName: user.isAnonymous ? 'Anonymous' : user.displayName || 'Guest',\n                rating: 0,\n                comment: ''\n            });\n        }).catch((e: any) => {\n            console.error(\"Error submitting review: \", e);\n            toast({\n                variant: \"destructive\",\n                title: \"Submission Failed\",\n                description: \"Could not submit your review. Please try again.\",\n            });\n        });\n  }\n\n  const cardVariants = {\n    hidden: { opacity: 0, y: 20 },\n    visible: (i: number) => ({\n      opacity: 1,\n      y: 0,\n      transition: {\n        delay: i * 0.1,\n        duration: 0.5,\n        ease: \"easeOut\",\n      },\n    }),\n  };\n  \n  const sortedReviews = useMemo(() => {\n    return reviews ? [...reviews].sort((a, b) => (b.createdAt?.toMillis() || 0) - (a.createdAt?.toMillis() || 0)) : [];\n  }, [reviews]);\n\n  return (\n    <div className=\"py-12 md:py-24 bg-white border border-gray-200 rounded-3xl mt-12 overflow-hidden\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-12 items-start\">\n          <div className=\"lg:col-span-1 space-y-6 lg:sticky top-24\">\n            <h2 className=\"text-3xl font-bold text-gray-900\">Share Your Thoughts</h2>\n            <p className=\"text-gray-600\">\n                Your feedback helps us improve and assists other shoppers. Let us know what you think about this product!\n            </p>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                <FormField\n                  control={form.control}\n                  name=\"userName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Your Name</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"e.g., Jane Doe\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                 <FormField\n                  control={form.control}\n                  name=\"rating\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Your Rating</FormLabel>\n                      <FormControl>\n                        <StarRatingInput value={field.value} onChange={field.onChange} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"comment\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Your Review</FormLabel>\n                      <FormControl>\n                        <Textarea placeholder=\"Tell us about your experience...\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <Button type=\"submit\" disabled={isSubmitting || isUserLoading} className=\"w-full\">\n                  {isSubmitting ? 'Submitting...' : 'Submit Review'}\n                  <Send className=\"ml-2 h-4 w-4\"/>\n                </Button>\n              </form>\n            </Form>\n          </div>\n          \n          <div className=\"lg:col-span-2\">\n            <h3 className=\"text-3xl font-bold text-gray-900 mb-6\">What Others Are Saying</h3>\n            <Carousel opts={{ align: \"start\" }} className=\"w-full\">\n              <CarouselContent className=\"-ml-4\">\n                {isLoadingReviews && Array.from({length: 3}).map((_, i) => (\n                    <CarouselItem key={i} className=\"md:basis-1/2 pl-4 h-[280px]\">\n                         <div className=\"p-1 h-full\">\n                            <Skeleton className=\"h-full w-full rounded-2xl\" />\n                         </div>\n                    </CarouselItem>\n                ))}\n                {!isLoadingReviews && sortedReviews.length === 0 && (\n                    <div className=\"w-full text-center py-12 text-gray-500\">\n                        <p>Be the first to review this product!</p>\n                    </div>\n                )}\n                <AnimatePresence>\n                  {sortedReviews.map((review, i) => (\n                    <CarouselItem key={review.id} className=\"md:basis-1/2 pl-4 h-[280px]\">\n                      <motion.div\n                        custom={i}\n                        initial=\"hidden\"\n                        animate=\"visible\"\n                        variants={cardVariants}\n                        className=\"h-full\"\n                      >\n                        <ReviewCard review={review} />\n                      </motion.div>\n                    </CarouselItem>\n                  ))}\n                </AnimatePresence>\n              </CarouselContent>\n            </Carousel>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1850, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/products/%5Bslug%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { notFound, useParams } from 'next/navigation';\nimport Image from 'next/image';\nimport ProductPurchaseForm from '@/components/product/product-purchase-form';\nimport { useState, useEffect } from 'react';\nimport type { Product } from '@/lib/types';\nimport { cn } from '@/lib/utils';\nimport { useCollection, useFirestore, useMemoFirebase } from '@/firebase';\nimport { collection, query, where, limit } from 'firebase/firestore';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport ProductReviews from '@/components/product/ProductReviews';\n\ntype ImageType = Product['images'][0];\n\nexport default function ProductPage() {\n  const { slug } = useParams<{ slug: string }>();\n  \n  const firestore = useFirestore();\n  const productQuery = useMemoFirebase(\n    () => firestore ? query(collection(firestore, 'products'), where('slug', '==', slug), limit(1)) : null,\n    [firestore, slug]\n  );\n  const { data: products, isLoading } = useCollection<Product>(productQuery);\n  const product = products?.[0];\n\n  const [primaryImage, setPrimaryImage] = useState<ImageType | undefined>(undefined);\n  const [isImageFading, setIsImageFading] = useState(false);\n  const [selectedColorHex, setSelectedColorHex] = useState<string | undefined>(undefined);\n\n  useEffect(() => {\n    if (product && !primaryImage) {\n        setPrimaryImage(product.images[0]);\n        setSelectedColorHex(product.availableColors?.[0]?.hex);\n    }\n  }, [product, primaryImage]);\n\n  useEffect(() => {\n    if (product && product.availableColors && selectedColorHex) {\n      const selectedColorName = product.availableColors.find(c => c.hex === selectedColorHex)?.name;\n      const newImage = product.images.find(img => img.colorName === selectedColorName);\n      \n      if (newImage && newImage.url !== primaryImage?.url) {\n        setIsImageFading(true);\n        setTimeout(() => {\n          setPrimaryImage(newImage);\n          setIsImageFading(false);\n        }, 1500);\n      } else if (!newImage && product.images[0] && primaryImage?.url !== product.images[0].url) {\n        setIsImageFading(true);\n        setTimeout(() => {\n          setPrimaryImage(product.images[0]);\n          setIsImageFading(false);\n        }, 1500);\n      }\n    } else if (product && !primaryImage && product.images[0]) {\n      setPrimaryImage(product.images[0]);\n    }\n  }, [selectedColorHex, product, primaryImage]);\n\n  const handleThumbnailClick = (image: ImageType) => {\n    if (primaryImage?.url === image.url) return;\n    \n    setIsImageFading(true);\n    setTimeout(() => {\n        setPrimaryImage(image);\n        if (image.colorName && product?.availableColors) {\n          const newColor = product.availableColors.find(c => c.name === image.colorName);\n          if (newColor && newColor.hex !== selectedColorHex) {\n            setSelectedColorHex(newColor.hex);\n          }\n        }\n        setIsImageFading(false);\n    }, 1500);\n  };\n  \n  if (isLoading) {\n    return (\n        <div className=\"py-2 md:py-8 lg:py-12 space-y-12\">\n            <div className=\"grid lg:grid-cols-2 lg:gap-12 items-start\">\n                <div className=\"space-y-4 lg:sticky lg:top-24\">\n                    <Skeleton className=\"aspect-square w-full rounded-2xl\" />\n                    <div className=\"grid grid-cols-4 gap-2\">\n                        <Skeleton className=\"aspect-square w-full rounded-lg\" />\n                        <Skeleton className=\"aspect-square w-full rounded-lg\" />\n                        <Skeleton className=\"aspect-square w-full rounded-lg\" />\n                        <Skeleton className=\"aspect-square w-full rounded-lg\" />\n                    </div>\n                </div>\n                <div className=\"space-y-6\">\n                    <Skeleton className=\"h-10 w-3/4\" />\n                    <Skeleton className=\"h-6 w-1/4\" />\n                    <Skeleton className=\"h-24 w-full\" />\n                    <Skeleton className=\"h-12 w-full rounded-full\" />\n                    <Skeleton className=\"h-12 w-full rounded-full\" />\n                </div>\n            </div>\n        </div>\n    )\n  }\n\n  if (!product) {\n    notFound();\n  }\n  \n  const thumbnailSlots: (ImageType | null)[] = new Array(4).fill(null);\n  if (product && product.images) {\n    const uniqueImages = product.images.reduce((acc, current) => {\n      if (!acc.find(item => item.url === current.url)) {\n        acc.push(current);\n      }\n      return acc;\n    }, [] as ImageType[]);\n\n    uniqueImages.slice(0, 4).forEach((image, index) => {\n      thumbnailSlots[index] = image;\n    });\n  }\n\n  return (\n    <>\n      <div className=\"py-2 md:py-8 lg:py-12 space-y-12\">\n        <div className=\"grid lg:grid-cols-2 lg:gap-12 items-start\">\n          {/* Image Gallery */}\n          <div className=\"space-y-4 lg:sticky lg:top-24\">\n            <div className=\"aspect-square relative rounded-2xl bg-gray-100 overflow-hidden shadow-lg\">\n              {primaryImage ? (\n                <Image\n                  src={primaryImage.url}\n                  alt={primaryImage.alt}\n                  fill\n                  className={cn(\n                    \"object-cover transition-opacity ease-in-out duration-[1500ms]\",\n                    isImageFading ? \"opacity-0\" : \"opacity-100\"\n                  )}\n                  sizes=\"(max-width: 1024px) 100vw, 50vw\"\n                  priority\n                  data-ai-hint={primaryImage.hint}\n                />\n              ) : (\n                <div className=\"w-full h-full bg-gray-200 flex items-center justify-center text-muted-foreground\">No Image</div>\n              )}\n            </div>\n            \n            <div className=\"grid grid-cols-4 gap-2\">\n              {thumbnailSlots.map((image, index) =>\n                image ? (\n                  <div\n                    key={index}\n                    className={cn(\n                      'aspect-square relative rounded-lg bg-black overflow-hidden cursor-pointer transition-all',\n                      primaryImage?.url === image.url\n                        ? 'ring-2 ring-primary ring-offset-2'\n                        : 'hover:opacity-75'\n                    )}\n                    onClick={() => handleThumbnailClick(image)}\n                  >\n                    <Image\n                      src={image.url}\n                      alt={image.alt}\n                      fill\n                      className=\"object-cover\"\n                      sizes=\"20vw\"\n                      data-ai-hint={image.hint}\n                    />\n                  </div>\n                ) : (\n                  <div\n                    key={`placeholder-${index}`}\n                    className=\"aspect-square rounded-lg bg-gray-100 border-2 border-dashed border-gray-300\"\n                  />\n                )\n              )}\n            </div>\n          </div>\n\n          {/* Product Info */}\n          <div className=\"bg-transparent lg:bg-gray-50/50 p-0 lg:p-2 rounded-2xl mt-6 lg:mt-0\">\n            <ProductPurchaseForm \n              product={product} \n              selectedColor={selectedColorHex} \n              setSelectedColor={setSelectedColorHex}\n            />\n          </div>\n        </div>\n      </div>\n      <ProductReviews productId={product.id} />\n    </>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}